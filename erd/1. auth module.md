erDiagram
    users ||--o{ refresh_tokens : "has"
    users ||--o{ organizations : "creates"
    users ||--o{ organization_members : "belongs to"
    users ||--o{ invitations : "invites"
    users ||--|| user_statuses : "has status"
    
    organizations ||--o{ organization_members : "has"
    organizations ||--o{ roles : "contains"
    organizations ||--o{ invitations : "sends"
    
    roles ||--o{ organization_members : "assigned to"
    roles ||--o{ role_permissions : "has"
    roles ||--o{ invitations : "offered in"
    
    permissions ||--o{ role_permissions : "included in"
    
    invitations ||--|| invitation_statuses : "has status"
    
    users {
        uuid id PK
        string first_name
        string last_name
        string email UK "unique"
        string password_hash
        uuid user_status_id FK
        boolean email_verified
        timestamp email_verified_at
        timestamp last_login_at
        timestamp created_at
        timestamp updated_at
    }
    
    user_statuses {
        uuid id PK
        string code UK "active, suspended, deleted"
        string label "Active, Suspended, Deleted"
        timestamp created_at
    }
    
    refresh_tokens {
        uuid id PK
        uuid user_id FK
        string token_hash UK "unique, hashed"
        boolean is_revoked
        timestamp revoked_at
        string device_info "optional"
        string ip_address "optional"
        timestamp expires_at
        timestamp created_at
    }
    
    organizations {
        uuid id PK
        string name
        uuid created_by FK "user who created"
        timestamp created_at
        timestamp updated_at
    }
    
    organization_members {
        uuid id PK
        uuid organization_id FK
        uuid user_id FK
        uuid role_id FK "required"
        timestamp joined_at
        timestamp created_at
    }
    
    roles {
        uuid id PK
        uuid organization_id FK
        string name
        boolean is_system_role "true for Owner role"
        boolean is_immutable "cannot be deleted/modified"
        timestamp created_at
        timestamp updated_at
    }
    
    permissions {
        uuid id PK
        string code UK "manage_users, deploy_updates"
        string label "Manage Users, Deploy Updates"
        string description
        string category "auth, deployment, billing"
        timestamp created_at
    }
    
    role_permissions {
        uuid id PK
        uuid role_id FK
        uuid permission_id FK
        timestamp created_at
    }
    
    invitations {
        uuid id PK
        uuid organization_id FK
        string email
        uuid role_id FK
        uuid invited_by FK
        uuid invitation_status_id FK
        string token UK "unique invitation token"
        timestamp expires_at
        timestamp responded_at
        timestamp created_at
        timestamp updated_at
    }
    
    invitation_statuses {
        uuid id PK
        string code UK "pending, accepted, rejected, expired"
        string label "Pending, Accepted, Rejected, Expired"
        timestamp created_at
    }